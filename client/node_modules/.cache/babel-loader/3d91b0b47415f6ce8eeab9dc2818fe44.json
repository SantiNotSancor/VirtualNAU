{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\PC\\\\OneDrive\\\\Escritorio\\\\fabrica\\\\client\\\\src\\\\Menu\\\\deliverTask.js\",\n    _s = $RefreshSig$();\n\nimport React, { Component } from 'react';\nimport { ModalOpener } from './modalOpener';\nimport { Request } from '../textInputs';\nimport Form from 'react-bootstrap/Form';\nimport image from './Images/DeliverTask.svg';\nimport moment from 'moment';\nimport Axios from 'axios';\nimport Table from 'react-bootstrap/Table';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Dropdown from 'react-bootstrap/Dropdown';\nimport DropdownButton from 'react-bootstrap/DropdownButton';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport class DeliverTask extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      task: '',\n      quantity: '',\n      money: '',\n      weight: '',\n      spare: false,\n      error: false\n    };\n\n    this.changeValue = (state, val) => {\n      this.setState({\n        [state]: val\n      });\n    };\n\n    this.myForm = () => {\n      return /*#__PURE__*/_jsxDEV(Form, {\n        children: [/*#__PURE__*/_jsxDEV(Request, {\n          toShow: \"name\",\n          onChange: element => {\n            this.setState({\n              name: element\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 31,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(TaskRequest, {\n          name: this.state.name,\n          onChange: (data, task, error) => {\n            this.setState({\n              task,\n              quantity: data.quantity,\n              money: data.money,\n              weight: data.weight,\n              error\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 35,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Form.Check, {\n          type: 'checkbox',\n          label: \"Perdonar lo faltante\",\n          onChange: () => this.setState({\n            spare: !this.state.spare\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 39,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 13\n      }, this);\n    };\n\n    this.post = () => {\n      Axios.post('http://localhost:3001/newPart', {\n        task: this.state.task,\n        date: moment(new Date()).format(\"DD/MM/YYYY\"),\n        quantity: this.state.quantity,\n        weight: this.state.weight,\n        money: this.state.money\n      });\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(ModalOpener, {\n      buttonText: \"Recibir tarea\",\n      children: this.myForm(),\n      className: 'title',\n      logo: image,\n      title: 'Ingreso de tarea',\n      post: this.post,\n      error: this.state.error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }, this) //Crea un botón que abre a un modal en el que aparecerá lo devuelto en this.myForm\n    ;\n  }\n\n}\nexport const TaskRequest = _ref => {\n  _s();\n\n  let {\n    onChange,\n    name\n  } = _ref;\n  const [tasks, setTasks] = useState([]);\n  const [title, setTitle] = useState('Elegir tarea');\n  const [parts, setParts] = useState([]);\n  const [input, setInput] = useState({\n    quantity: 0,\n    weight: 0,\n    money: 0\n  });\n  const [selectedTask, setSelectedTask] = useState('');\n  useEffect(() => {\n    if (name === '') return;\n    Axios.post('http://localhost:3001/getTasks', {\n      name\n    }).then(response => {\n      if (response.data.length === 0) return;\n      setTasks(response.data);\n    });\n  }, [name]);\n  useEffect(() => {\n    Axios.post('http://localhost:3001/getParts', {\n      task: selectedTask.id\n    }).then(response => setParts(response.data));\n  }, [selectedTask]);\n  useEffect(() => {\n    onChange(input, selectedTask.id, input.quantity > 0 && input.weight > 0 && input.money >= 0);\n  }, [input]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const getTable = () => {\n    let total = {\n      quantity: selectedTask.quantity,\n      weight: selectedTask.weight,\n      money: selectedTask.quantity * selectedTask.price\n    };\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [parts.map((part, index) => {\n        total = {\n          quantity: total.quantity - part.quantity,\n          weight: total.weight - part.weight,\n          money: total.money - part.money\n        };\n        return /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: part.date\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: part.quantity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: total.quantity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: part.weight\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: total.weight\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: part.money\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: total.money\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 29\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 25\n        }, this);\n      }), /*#__PURE__*/_jsxDEV(\"tr\", {\n        children: [/*#__PURE__*/_jsxDEV(\"td\", {\n          children: moment(new Date()).format(\"DD/MM/YYYY\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: /*#__PURE__*/_jsxDEV(FormControl, {\n            value: input.quantity,\n            onChange: e => {\n              if (isNaN(e.target.value)) return;\n              let aux = { ...input\n              };\n              aux.quantity = total.quantity < e.target.value ? total.quantity : e.target.value;\n              aux.quantity = e.target.value < 0 ? 0 : e.target.value;\n              aux.quantity = Math.round(e.target.value);\n              setInput({ ...aux\n              });\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: total.quantity - input.quantity\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: /*#__PURE__*/_jsxDEV(FormControl, {\n            value: input.weight,\n            onChange: e => {\n              if (isNaN(e.target.value)) return;\n              let aux = { ...input\n              };\n              aux.weight = total.weight < e.target.value ? total.weight : e.target.value;\n              aux.weight = e.target.value < 0 ? 0 : e.target.value;\n              setInput({ ...aux\n              });\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: total.weight - input.weight\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: /*#__PURE__*/_jsxDEV(FormControl, {\n            value: input.money,\n            onChange: e => {\n              if (isNaN(e.target.value)) return;\n              let aux = { ...input\n              };\n              aux.money = total.money < e.target.value ? total.money : e.target.value;\n              aux.money = e.target.value < 0 ? 0 : e.target.value;\n              setInput({ ...aux\n              });\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: total.money - input.money\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(DropdownButton, {\n      title: title,\n      onSelect: e => {\n        setTitle('Tarea ' + tasks[e].id);\n        setSelectedTask(tasks[e]);\n      },\n      children: tasks.map((task, index) => {\n        return /*#__PURE__*/_jsxDEV(Dropdown.Item, {\n          eventKey: index,\n          children: task.id + \": \" + task.article_id + \" (\" + task.article_description + \") x\" + task.quantity\n        }, task.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 25\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }, this), title === 'Elegir tarea' ? /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false) : /*#__PURE__*/_jsxDEV(Table, {\n      striped: true,\n      bordered: true,\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Fecha\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Cantidad entregada\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Cantidad total\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Peso entregado\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Peso total\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Dinero entregado\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Dinero total\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: selectedTask.date\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: selectedTask.quantity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: selectedTask.weight\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: selectedTask.price * selectedTask.quantity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 25\n        }, this), getTable()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true);\n};\n\n_s(TaskRequest, \"reT0MbOWZ19VQOuGX+C+/baGakc=\");\n\n_c = TaskRequest;\n\nvar _c;\n\n$RefreshReg$(_c, \"TaskRequest\");","map":{"version":3,"sources":["C:/Users/PC/OneDrive/Escritorio/fabrica/client/src/Menu/deliverTask.js"],"names":["React","Component","ModalOpener","Request","Form","image","moment","Axios","Table","FormControl","Dropdown","DropdownButton","DeliverTask","state","task","quantity","money","weight","spare","error","changeValue","val","setState","myForm","element","name","data","post","date","Date","format","render","TaskRequest","onChange","tasks","setTasks","useState","title","setTitle","parts","setParts","input","setInput","selectedTask","setSelectedTask","useEffect","then","response","length","id","getTable","total","price","map","part","index","e","isNaN","target","value","aux","Math","round","article_id","article_description"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { ModalOpener } from './modalOpener';\r\nimport { Request } from '../textInputs';\r\nimport Form from 'react-bootstrap/Form';\r\nimport image from './Images/DeliverTask.svg';\r\nimport moment from 'moment';\r\nimport Axios from 'axios';\r\nimport Table from 'react-bootstrap/Table';\r\nimport FormControl from 'react-bootstrap/FormControl';\r\nimport Dropdown from 'react-bootstrap/Dropdown';\r\nimport DropdownButton from 'react-bootstrap/DropdownButton';\r\n\r\n\r\nexport class DeliverTask extends Component {\r\n    state = {\r\n        task: '',\r\n        quantity: '',\r\n        money: '',\r\n        weight: '',\r\n        spare: false,\r\n        error: false\r\n    }\r\n\r\n    changeValue = (state, val) => {\r\n        this.setState({ [state]: val });\r\n    }\r\n\r\n    myForm = () => {\r\n        return (\r\n            <Form>\r\n                <Request toShow=\"name\" onChange={(element) => {\r\n                    this.setState({ name: element });\r\n                }} />\r\n\r\n                <TaskRequest name={this.state.name} onChange={(data, task, error) => {\r\n                    this.setState({ task, quantity: data.quantity, money: data.money, weight: data.weight, error });\r\n                }} />\r\n\r\n                <Form.Check\r\n                    type={'checkbox'}\r\n                    label=\"Perdonar lo faltante\"\r\n                    onChange={() => this.setState({ spare: !this.state.spare })}\r\n                />\r\n            </Form>\r\n        );\r\n    }\r\n\r\n    post = () => {\r\n        Axios.post('http://localhost:3001/newPart',\r\n            {\r\n                task: this.state.task, date: moment(new Date()).format(\"DD/MM/YYYY\"), quantity: this.state.quantity,\r\n                weight: this.state.weight, money: this.state.money\r\n            });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <ModalOpener buttonText='Recibir tarea' children={this.myForm()}\r\n                className={'title'} logo={image} title={'Ingreso de tarea'} post={this.post} error={this.state.error}/>\r\n            //Crea un botón que abre a un modal en el que aparecerá lo devuelto en this.myForm\r\n        );\r\n    }\r\n}\r\n\r\nexport const TaskRequest = ({ onChange, name }) => {\r\n\r\n    const [tasks, setTasks] = useState([]);\r\n    const [title, setTitle] = useState('Elegir tarea');\r\n    const [parts, setParts] = useState([]);\r\n    const [input, setInput] = useState({ quantity: 0, weight: 0, money: 0 });\r\n    const [selectedTask, setSelectedTask] = useState('');\r\n\r\n    useEffect(() => {\r\n        if (name === '')\r\n            return;\r\n        Axios.post('http://localhost:3001/getTasks', { name }).then((response) => {\r\n            if (response.data.length === 0)\r\n                return;\r\n            setTasks(response.data);\r\n        })\r\n    }, [name]);\r\n\r\n    useEffect(() => {\r\n        Axios.post('http://localhost:3001/getParts', { task: selectedTask.id }).then((response) =>\r\n            setParts(response.data)\r\n        );\r\n    }, [selectedTask]);\r\n\r\n    useEffect(() => {\r\n        onChange(input, selectedTask.id,\r\n            (input.quantity > 0 && input.weight > 0 && input.money >= 0));\r\n    }, [input]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n    const getTable = () => {\r\n\r\n        let total = {\r\n            quantity: selectedTask.quantity,\r\n            weight: selectedTask.weight,\r\n            money: selectedTask.quantity * selectedTask.price\r\n        };\r\n        return (\r\n            <>\r\n                {parts.map((part, index) => {\r\n                    total = {\r\n                        quantity: total.quantity - part.quantity,\r\n                        weight: total.weight - part.weight,\r\n                        money: total.money - part.money\r\n                    };\r\n\r\n                    return (\r\n                        <tr key={index}>\r\n                            <td>{part.date}</td>\r\n                            <td>{part.quantity}</td>\r\n                            <td>{total.quantity}</td>\r\n                            <td>{part.weight}</td>\r\n                            <td>{total.weight}</td>\r\n                            <td>{part.money}</td>\r\n                            <td>{total.money}</td>\r\n                        </tr>\r\n                    );\r\n                })}\r\n                <tr>\r\n\r\n                    <td>{moment(new Date()).format(\"DD/MM/YYYY\")}</td>\r\n\r\n                    <td><FormControl value={input.quantity} onChange={(e) => {\r\n                        if(isNaN(e.target.value))\r\n                            return;\r\n                        let aux = { ...input };\r\n                        aux.quantity = (total.quantity < e.target.value) ? total.quantity : e.target.value;\r\n                        aux.quantity = (e.target.value < 0) ? 0 : e.target.value;\r\n                        aux.quantity = Math.round(e.target.value);\r\n                        setInput({ ...aux });\r\n                    }} /></td>\r\n\r\n                    <td>{total.quantity - input.quantity}</td>\r\n\r\n                    <td><FormControl value={input.weight} onChange={(e) => {\r\n                        if(isNaN(e.target.value))\r\n                            return;\r\n                        let aux = { ...input };\r\n                        aux.weight = (total.weight < e.target.value) ? total.weight : e.target.value;\r\n                        aux.weight = (e.target.value < 0) ? 0 : e.target.value;\r\n                        setInput({ ...aux });\r\n                    }} /></td>\r\n\r\n                    <td>{total.weight - input.weight}</td>\r\n\r\n                    <td><FormControl value={input.money} onChange={(e) => {\r\n                        if(isNaN(e.target.value))\r\n                            return;\r\n                        let aux = { ...input };\r\n                        aux.money = (total.money < e.target.value) ? total.money : e.target.value;\r\n                        aux.money = (e.target.value < 0) ? 0 : e.target.value;\r\n                        setInput({ ...aux });\r\n                    }} /></td>\r\n\r\n                    <td>{total.money - input.money}</td>\r\n\r\n                </tr>\r\n            </>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <DropdownButton title={title} onSelect={(e) => {\r\n                setTitle('Tarea ' + tasks[e].id);\r\n                setSelectedTask(tasks[e]);\r\n            }}>\r\n                {tasks.map((task, index) => {\r\n                    return (\r\n                        <Dropdown.Item key={task.id} eventKey={index}>\r\n                            {task.id + \": \" + task.article_id + \" (\" + task.article_description + \") x\" + task.quantity}\r\n                        </Dropdown.Item>\r\n                    );\r\n                })}\r\n            </DropdownButton>\r\n            {title === 'Elegir tarea' ? <></> :\r\n                <Table striped bordered>\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Fecha</th>\r\n                            <th>Cantidad entregada</th>\r\n                            <th>Cantidad total</th>\r\n                            <th>Peso entregado</th>\r\n                            <th>Peso total</th>\r\n                            <th>Dinero entregado</th>\r\n                            <th>Dinero total</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr>\r\n                            <td>{selectedTask.date}</td>\r\n                            <td></td>\r\n                            <td>{selectedTask.quantity}</td>\r\n                            <td></td>\r\n                            <td>{selectedTask.weight}</td>\r\n                            <td></td>\r\n                            <td>{selectedTask.price * selectedTask.quantity}</td>\r\n                        </tr>\r\n                        {getTable()}\r\n                    </tbody>\r\n                </Table>}\r\n        </>\r\n    );\r\n}"]},"metadata":{},"sourceType":"module"}