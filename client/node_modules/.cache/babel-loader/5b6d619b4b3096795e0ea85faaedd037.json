{"ast":null,"code":"var _jsxFileName = \"D:\\\\Users\\\\PC\\\\VirtualNAU\\\\client\\\\src\\\\WorkshopsAdm\\\\deliverTask.js\",\n    _s = $RefreshSig$();\n\nimport React, { Component, useState, useEffect } from 'react';\nimport { ModalOpener } from '../modalOpener';\nimport { Request, TaskRequest } from '../textInputs';\nimport Form from 'react-bootstrap/Form';\nimport image from './Images/DeliverTask.svg';\nimport moment from 'moment';\nimport Axios from 'axios';\nimport Table from 'react-bootstrap/Table';\nimport FormControl from 'react-bootstrap/FormControl';\nimport { ModalPrototype } from '../modal';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  error: true,\n  errors: [true, true],\n  showObsModal: false,\n  task: '',\n  name: '',\n  quantity: '',\n  money: '',\n  weight: '',\n  threads: '',\n  price: '',\n  faulty: '',\n  completed: false,\n  calification: '',\n  observation: '',\n  paid: false,\n  workshopAccount: ''\n};\nexport class DeliverTaskButton extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = initialState;\n    this.form = /*#__PURE__*/React.createRef();\n\n    this.resetState = () => {\n      this.setState(initialState);\n    };\n\n    this.updateError = (index, error) => {\n      let errors = [...this.state.errors];\n      errors[index] = error;\n      this.setState({\n        errors\n      });\n      let aux = false;\n      errors.map((e, key) => aux = aux && key === index ? error : e);\n      this.setState({\n        error: aux\n      });\n    };\n\n    this.handleEnter = event => {\n      if (event.key.toLowerCase() !== 'enter') return;\n      const form = this.form.current;\n      const index = [...form].indexOf(event.target);\n      if (form.elements[index + 1]) form.elements[index + 1].focus();\n    };\n\n    this.myForm = () => {\n      return /*#__PURE__*/_jsxDEV(Form, {\n        id: \"toPrint\",\n        ref: this.form,\n        onSubmit: e => e.preventDefault(),\n        children: [/*#__PURE__*/_jsxDEV(Request, {\n          toShow: \"workshopName\",\n          handleEnter: this.handleEnter,\n          onChange: (value, error) => {\n            this.setState({\n              name: value\n            });\n            this.updateError(0, error);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          name: this.state.name,\n          onChange: (data, price, faulty, task, completed, paid, workshopAccount, usedAccount) => {\n            this.setState({\n              task,\n              quantity: data.quantity,\n              money: Number(data.money) + Number(usedAccount),\n              weight: data.weight,\n              threads: data.threads,\n              completed,\n              price,\n              faulty,\n              paid,\n              workshopAccount\n            });\n            this.updateError(1, false);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 13\n      }, this);\n    };\n\n    this.post = () => {\n      let {\n        completed,\n        task,\n        money,\n        weight,\n        name,\n        quantity,\n        price,\n        threads,\n        paid,\n        workshopAccount\n      } = this.state;\n      if (!completed) this.resetState();\n      Axios.post('http://localhost:3307/getTasks', {\n        id: task\n      }).then(response => {\n        Axios.put('http://localhost:3307/payWorkshop', {\n          name: response.data[0].name,\n          money: money - quantity * price\n        });\n      });\n      Axios.post('http://localhost:3307/newPart', {\n        name,\n        task,\n        date: moment(new Date()).format('DD/MM/YYYY'),\n        quantity,\n        threads,\n        paid,\n        weight: Number(weight).toFixed(1),\n        money: Number(money).toFixed(1)\n      }).then(() => {\n        if (completed) this.setState({\n          showObsModal: true\n        });\n      });\n      Axios.put('http://localhost:3307/setAccount', {\n        money: workshopAccount,\n        name\n      }); //Actualizar el dinero que posee a cuenta el taller\n    };\n\n    this.completelyReturned = () => {\n      Axios.put('http://localhost:3307/printObs', {\n        id: this.state.task,\n        observations: this.state.observation,\n        calification: this.state.calification,\n        faulty: this.state.faulty\n      });\n    };\n\n    this.print = () => {\n      if (this.state.error) {\n        alert('Error. No se puede imprimir una boleta inválida.');\n        return;\n      }\n\n      var printContents = document.getElementById('toPrint').innerHTML;\n      var originalContents = document.body.innerHTML;\n      document.body.innerHTML = printContents;\n      window.print();\n      document.body.innerHTML = originalContents;\n    };\n\n    this.sendObs = () => {\n      this.completelyReturned();\n      this.resetState();\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(ModalOpener, {\n        buttonText: \"Recibir tarea\",\n        children: this.myForm(),\n        logo: image,\n        className: \"title\",\n        footer: {\n          label: 'Imprimir',\n          func: this.print,\n          show: !!document.getElementById(\"taskTable\")\n        },\n        title: \"Ingreso de tarea\",\n        post: this.post,\n        error: this.state.error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ModalPrototype, {\n        title: \"Calificar\",\n        show: this.state.showObsModal,\n        post: this.sendObs,\n        handleClose: this.sendObs,\n        children: /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Request, {\n            toShow: \"observation\",\n            onChange: e => this.setState({\n              observation: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Request, {\n            toShow: \"calification\",\n            onChange: e => this.setState({\n              calification: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true);\n  }\n\n}\nexport const Input = _ref => {\n  _s();\n\n  let {\n    onChange,\n    name\n  } = _ref;\n  const [title, setTitle] = useState('Elegir tarea'); //Título del selectBox. Primero va a ser 'Elegir tarea' pero luego va a mostrar la tarea elegida\n\n  const [tasks, setTasks] = useState([]); //Todas las tareas que no se le pagaron por completo al taller\n\n  const [parts, setParts] = useState([]); //Todas las entregas parciales de la tarea elegida\n\n  const [input, setInput] = useState({\n    quantity: 0,\n    weight: 0,\n    money: 0,\n    threads: 0\n  }); //Lo ingresado por el usuario en la tabla\n\n  const [selectedTask, setSelectedTask] = useState(''); //La tarea elegida\n\n  const [refund, setRefund] = useState(false); //Está cargando una devolución?\n\n  const [completed, setCompleted] = useState(false); //El taller entregó el total de la mercadería?\n\n  const [actualAccount, setActualAccount] = useState(''); //Dinero que le fue pagado al taller anteriormente (la cuenta corriente)\n\n  const [account, setAccount] = useState(''); //Dinero que le fue pagado al taller anteriormente (la cuenta corriente) y que ahora se utilizará para pagar la tarea\n\n  const [delivered, setDelivered] = useState(''); //Cantidad entregada en todas las partes\n\n  const [quantityBackUp, setQuantityBackUp] = useState(''); //Una variable auxiliar para recordar la cantidad, de esta forma podremos saber cuándo cambia\n\n  useEffect(() => {\n    //Cuando selectedTask cambia...\n    setInput({\n      quantity: 0,\n      weight: 0,\n      money: 0,\n      threads: 0\n    }); //Resetear los valores de Input (porque el usuario no ingresó nada)\n\n    Axios.post('http://localhost:3307/getParts', {\n      task: selectedTask.id\n    }).then(response => setParts(response.data)); //Recuperar partes desde la BD y asignarselas a parts\n\n    if (name) //Si se sabe el nombre del taller...\n      Axios.post('http://localhost:3307/getAccount', {\n        name\n      }).then(response => {\n        //Recuperar de la BD la cuenta corriente del taller\n        let owedMoney = (selectedTask.quantity - delivered) * selectedTask.price,\n            res = response.data[0].money; //owedMoney es lo que falta pagar para que la tarea entera esté paga y res es la cuenta corriente del taller\n\n        setActualAccount(res);\n        console.log(owedMoney);\n        console.log(res);\n        console.log(owedMoney < res ? owedMoney : res);\n        setAccount(owedMoney < res ? owedMoney : res); //account debe ser el menor de owedMoney y res, ya que si owedMoney es mayor a res, no alcanza a pagar todo, mientras que si totalMoney es menor a res, el taller va a tener un resto de cuenta corriente\n      });\n  }, [selectedTask]);\n  useEffect(() => {\n    let delivered = input.quantity,\n        totalMoney = selectedTask.quantity * selectedTask.price; //delivered es la cantidad total devuelta por el taller (en todas las partes) y totalMoney es lo que se deberá pagar por la tarea entera\n\n    parts.map(part => delivered += part.quantity); //Sumar a delivered todas las cantidades entregadas en cada parte\n\n    setDelivered(delivered);\n\n    if (quantityBackUp !== input.quantity) {\n      //Si se modificó la cantidad\n      input.money = input.quantity * selectedTask.price - account; //Le recomienda al usuario pagar todo lo que debe pagar (lo entregado en esta parte * el precio acordado - la cuenta corriente de esta parte)\n\n      input.money = input.money < 0 ? 0 : input.money; //No se le puede recomendar pagar un número negativo\n\n      setQuantityBackUp(input.quantity); //Volver a actualizar la cantidad\n    }\n\n    onChange(input, selectedTask.price, selectedTask.quantity - delivered, selectedTask.id, //Se envían los cambios\n    delivered === selectedTask.quantity || completed, totalMoney - input.quantity < 0, actualAccount - account, account); //onChange(data, price, faulty, task, completed, paid, workshopAccount, usedAccount)//objeto con todo lo ingresado, precio, artículos fallados, id de tarea, si se entregaron todos los artículos, si se pagó la totalidad de la tarea, lo que le quedará de cuenta corriente al taller luego de la parte y la cantidad de dinero utilizado de la cuenta corriente\n    //workshopAccount: Previamente nosotros hicimos \"setAccount((totalMoney < res) ? totalMoney : res);\". La cuenta corriente del taller quedará: Si account === totalMoney, res - totalMoney, de otra forma, 0\n  }, [input, completed, refund]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const inputField = (property, total) => {\n    //Función que devuelve un inputbox para ingresar datos al objeto input. propery\n    //property es la propiedad de input que se quiere modificar con el inputbox y total es el objeto que contiene todos los totales\n    return /*#__PURE__*/_jsxDEV(FormControl, {\n      value: input[property] //Asignar al inputbox la variable input[property], es decir que cada vez que el inputbox se modifica, la variable también y vice versa\n      ,\n      onChange: e => {\n        //Cuando cambia el inputbox...\n        if (isNaN(e.target.value) || total[property] < e.target.value && property !== 'money') //Si el valor es inválido...\n          return; //Cancelar\n\n        let aux = { ...input\n        };\n        aux[property] = e.target.value;\n        aux[property] = refund ? //Si se está haciendo una devolución de mercadería o se contó mal la mercadería en una parte anterior\n        -Math.abs(aux[property]) : //Poner en negativo lo ingresado (así se suma y no se resta al total)\n        aux[property] < 0 ? 0 : aux[property]; //Si la propiedad es negativa, convertir en 0\n\n        if (property === 'quantity' || property === 'threads') //Si la propiedad es cantidad o hilos...\n          aux[property] = Math.round(aux[property]); //No puede ser decimal\n\n        setInput({ ...aux\n        });\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 13\n    }, this);\n  }; // const updateAccount = () => {//TODO: Ejecutar sólo cuando se aprieta enviar\n  //     let totalMoney = selectedTask.quantity * selectedTask.price;//totalMoney es lo que se deberá pagar por la tarea entera\n  //     //Previamente nosotros hicimos \"setAccount((totalMoney < res) ? totalMoney : res);\"\n  //     //La cuenta corriente del taller quedará: Si account === totalMoney, res - totalMoney, de otra forma, 0\n  //     Axios.put('http://localhost:3307/setAccount', { money: ((totalMoney === account) ? res - totalMoney : 0), name })//Actualizar el dinero que posee a cuenta el taller\n  // }\n\n\n  const getTable = () => {\n    let total = {\n      quantity: selectedTask.quantity,\n      weight: selectedTask.weight,\n      money: selectedTask.quantity * selectedTask.price,\n      threads: selectedTask.threads\n    };\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [parts.map((part, index) => {\n        total = {\n          quantity: total.quantity - part.quantity,\n          weight: total.weight - part.weight,\n          money: total.money - part.money,\n          threads: total.threads - part.threads\n        };\n        return /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: part.date\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: part.quantity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: total.quantity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: Number(part.weight).toFixed(1)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: Number(total.weight).toFixed(1)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: part.threads\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: total.threads\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: '$' + Number(part.money).toFixed(1)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: '$' + Number(total.money).toFixed(1)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 29\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 25\n        }, this);\n      }), /*#__PURE__*/_jsxDEV(\"tr\", {\n        children: [/*#__PURE__*/_jsxDEV(\"td\", {\n          children: moment(new Date()).format('DD/MM/YYYY')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: inputField('quantity', total)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: total.quantity - input.quantity\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: inputField('weight', total)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: (total.weight - input.weight).toFixed(1)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: inputField('threads', total)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: total.threads - input.threads\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: inputField('money', total)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: '$' + account\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: '$' + (total.money - input.money - account).toFixed(1)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true);\n  };\n\n  const getExceeded = () => {\n    //Devuelve true si se excedió la fecha de entrega\n    if (!selectedTask.deadline) return;\n    let today = new Date();\n    today.setHours(0, 0, 0, 0);\n    var dateParts = selectedTask.deadline.split('/');\n    var deadline = new Date(+dateParts[2], dateParts[1] - 1, +dateParts[0]);\n    return today > deadline;\n  };\n\n  if (name !== '') {\n    Axios.post('http://localhost:3307/getUnpaidTasks', {\n      name\n    }).then(response => {\n      if (response.data.length === 0) return;\n      setTasks(response.data);\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        'justifyContent': 'space-between',\n        'display': 'flex',\n        'alignItems': 'baseline'\n      },\n      children: [/*#__PURE__*/_jsxDEV(TaskRequest, {\n        setSelectedTask: setSelectedTask,\n        tasks: tasks,\n        title: title,\n        setTitle: setTitle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        style: {\n          'color': getExceeded() ? 'red' : 'green'\n        },\n        children: selectedTask === '' ? null : selectedTask.deadline\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 13\n    }, this), title === 'Elegir tarea' ? /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Form.Check, {\n        onChange: () => {\n          setRefund(!refund);\n          input.money = -input.money;\n          input.quantity = -input.quantity;\n          input.threads = -input.threads;\n          input.weight = -input.weight;\n        },\n        label: \"Devoluci\\xF3n o correcci\\xF3n\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Form.Check, {\n        onChange: () => setCompleted(!completed),\n        label: \"Tarea cerrada\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Table, {\n        striped: true,\n        bordered: true,\n        id: \"taskTable\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Fecha\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Cantidad entregada por el taller\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 299,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Cantidad total de la tarea\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 300,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Peso entregado por el taller\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Peso total\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Hilos devueltos\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Hilos totales\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Dinero entregado\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Dinero a cuenta\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Dinero total\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n            style: {\n              'backgroundColor': 'green'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: selectedTask.exitDate\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 312,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: selectedTask.quantity\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: selectedTask.weight\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 317,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: selectedTask.threads\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 318,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 320,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: '$' + selectedTask.price * selectedTask.quantity\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 29\n          }, this), getTable()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true);\n};\n\n_s(Input, \"FtKd49952iNaWH3ePgNOssvTTYs=\");\n\n_c = Input;\n\nvar _c;\n\n$RefreshReg$(_c, \"Input\");","map":{"version":3,"sources":["D:/Users/PC/VirtualNAU/client/src/WorkshopsAdm/deliverTask.js"],"names":["React","Component","useState","useEffect","ModalOpener","Request","TaskRequest","Form","image","moment","Axios","Table","FormControl","ModalPrototype","initialState","error","errors","showObsModal","task","name","quantity","money","weight","threads","price","faulty","completed","calification","observation","paid","workshopAccount","DeliverTaskButton","state","form","createRef","resetState","setState","updateError","index","aux","map","e","key","handleEnter","event","toLowerCase","current","indexOf","target","elements","focus","myForm","preventDefault","value","data","usedAccount","Number","post","id","then","response","put","date","Date","format","toFixed","completelyReturned","observations","print","alert","printContents","document","getElementById","innerHTML","originalContents","body","window","sendObs","render","label","func","show","Input","onChange","title","setTitle","tasks","setTasks","parts","setParts","input","setInput","selectedTask","setSelectedTask","refund","setRefund","setCompleted","actualAccount","setActualAccount","account","setAccount","delivered","setDelivered","quantityBackUp","setQuantityBackUp","owedMoney","res","console","log","totalMoney","part","inputField","property","total","isNaN","Math","abs","round","getTable","getExceeded","deadline","today","setHours","dateParts","split","length","exitDate"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect } from 'react';\r\nimport { ModalOpener } from '../modalOpener';\r\nimport { Request, TaskRequest } from '../textInputs';\r\nimport Form from 'react-bootstrap/Form';\r\nimport image from './Images/DeliverTask.svg';\r\nimport moment from 'moment';\r\nimport Axios from 'axios';\r\nimport Table from 'react-bootstrap/Table';\r\nimport FormControl from 'react-bootstrap/FormControl';\r\nimport { ModalPrototype } from '../modal';\r\n\r\nconst initialState = {\r\n    error: true,\r\n    errors: [true, true],\r\n    showObsModal: false,\r\n    task: '',\r\n    name: '',\r\n    quantity: '',\r\n    money: '',\r\n    weight: '',\r\n    threads: '',\r\n    price: '',\r\n    faulty: '',\r\n    completed: false,\r\n    calification: '',\r\n    observation: '',\r\n    paid: false,\r\n    workshopAccount: ''\r\n}\r\n\r\nexport class DeliverTaskButton extends Component {\r\n    state = initialState;\r\n    form = React.createRef();\r\n\r\n    resetState = () => {\r\n        this.setState(initialState);\r\n    }\r\n\r\n    updateError = (index, error) => {\r\n        let errors = [...this.state.errors];\r\n        errors[index] = error;\r\n        this.setState({ errors });\r\n\r\n        let aux = false;\r\n        errors.map((e, key) =>\r\n            aux = aux && (key === index) ? error : e\r\n        );\r\n        this.setState({ error: aux });\r\n    }\r\n\r\n    handleEnter = (event) => {\r\n        if (event.key.toLowerCase() !== 'enter')\r\n            return;\r\n        const form = this.form.current;\r\n        const index = [...form].indexOf(event.target);\r\n        if (form.elements[index + 1])\r\n            form.elements[index + 1].focus();\r\n    };\r\n\r\n    myForm = () => {\r\n        return (\r\n            <Form id='toPrint' ref={this.form} onSubmit={e => e.preventDefault()}>\r\n                <Request toShow=\"workshopName\" handleEnter={this.handleEnter} onChange={(value, error) => {\r\n                    this.setState({ name: value });\r\n                    this.updateError(0, error);\r\n                }} />\r\n                <Input name={this.state.name} onChange={(data, price, faulty, task, completed, paid, workshopAccount, usedAccount) => {\r\n                    this.setState({\r\n                        task, quantity: data.quantity, money: Number(data.money) + Number(usedAccount), weight: data.weight,\r\n                        threads: data.threads, completed, price, faulty, paid, workshopAccount\r\n                    });\r\n                    this.updateError(1, false);\r\n                }} />\r\n            </Form>\r\n        );\r\n    }\r\n\r\n    post = () => {\r\n        let {completed, task, money, weight, name, quantity, price, threads, paid, workshopAccount} = this.state;\r\n        if (!completed)\r\n            this.resetState();\r\n        Axios.post('http://localhost:3307/getTasks', { id: task }).then((response) => {\r\n            Axios.put('http://localhost:3307/payWorkshop',\r\n                { name: response.data[0].name, money: money - quantity * price })\r\n        });\r\n        Axios.post('http://localhost:3307/newPart',\r\n            {\r\n                name, task, date: moment(new Date()).format('DD/MM/YYYY'), quantity, threads, paid,\r\n                weight: Number(weight).toFixed(1), money: Number(money).toFixed(1)\r\n            }).then(() => {\r\n                if (completed)\r\n                    this.setState({ showObsModal: true });\r\n            });\r\n            Axios.put('http://localhost:3307/setAccount', { money: workshopAccount, name })//Actualizar el dinero que posee a cuenta el taller\r\n    }\r\n\r\n    completelyReturned = () => {\r\n        Axios.put('http://localhost:3307/printObs',\r\n            {\r\n                id: this.state.task, observations: this.state.observation, calification: this.state.calification,\r\n                faulty: this.state.faulty\r\n            });\r\n    }\r\n\r\n    print = () => {\r\n        if (this.state.error) {\r\n            alert('Error. No se puede imprimir una boleta inválida.');\r\n            return;\r\n        }\r\n        var printContents = document.getElementById('toPrint').innerHTML;\r\n        var originalContents = document.body.innerHTML;\r\n        document.body.innerHTML = printContents;\r\n        window.print();\r\n        document.body.innerHTML = originalContents;\r\n    }\r\n\r\n    sendObs = () => {\r\n        this.completelyReturned();\r\n        this.resetState();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                <ModalOpener buttonText=\"Recibir tarea\" children={this.myForm()} logo={image} className=\"title\"\r\n                    footer={{ label: 'Imprimir', func: this.print, show: !!document.getElementById(\"taskTable\") }}\r\n                    title=\"Ingreso de tarea\" post={this.post} error={this.state.error} />\r\n                {/*Crea un botón que abre a un modal en el que aparecerá lo devuelto en this.myForm*/}\r\n\r\n                <ModalPrototype title=\"Calificar\" show={this.state.showObsModal} post={this.sendObs} handleClose={this.sendObs}>\r\n                    <>\r\n                        <Request toShow=\"observation\" onChange={(e) => this.setState({ observation: e.target.value })} />\r\n                        <Request toShow=\"calification\" onChange={(e) => this.setState({ calification: e.target.value })} />\r\n                    </>\r\n                </ModalPrototype>\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport const Input = ({ onChange, name }) => {\r\n\r\n    const [title, setTitle] = useState('Elegir tarea'); //Título del selectBox. Primero va a ser 'Elegir tarea' pero luego va a mostrar la tarea elegida\r\n    const [tasks, setTasks] = useState([]);//Todas las tareas que no se le pagaron por completo al taller\r\n    const [parts, setParts] = useState([]);//Todas las entregas parciales de la tarea elegida\r\n    const [input, setInput] = useState({ quantity: 0, weight: 0, money: 0, threads: 0 });//Lo ingresado por el usuario en la tabla\r\n    const [selectedTask, setSelectedTask] = useState('');//La tarea elegida\r\n    const [refund, setRefund] = useState(false);//Está cargando una devolución?\r\n    const [completed, setCompleted] = useState(false);//El taller entregó el total de la mercadería?\r\n    const [actualAccount, setActualAccount] = useState('');//Dinero que le fue pagado al taller anteriormente (la cuenta corriente)\r\n    const [account, setAccount] = useState('');//Dinero que le fue pagado al taller anteriormente (la cuenta corriente) y que ahora se utilizará para pagar la tarea\r\n    const [delivered, setDelivered] = useState('');//Cantidad entregada en todas las partes\r\n    const [quantityBackUp, setQuantityBackUp] = useState('');//Una variable auxiliar para recordar la cantidad, de esta forma podremos saber cuándo cambia\r\n\r\n    useEffect(() => {//Cuando selectedTask cambia...\r\n        setInput({ quantity: 0, weight: 0, money: 0, threads: 0 });//Resetear los valores de Input (porque el usuario no ingresó nada)\r\n        Axios.post('http://localhost:3307/getParts', { task: selectedTask.id }).then(response => setParts(response.data));//Recuperar partes desde la BD y asignarselas a parts\r\n        if (name)//Si se sabe el nombre del taller...\r\n            Axios.post('http://localhost:3307/getAccount', { name }).then(response => {//Recuperar de la BD la cuenta corriente del taller\r\n                let owedMoney = (selectedTask.quantity - delivered) * selectedTask.price, res = response.data[0].money;//owedMoney es lo que falta pagar para que la tarea entera esté paga y res es la cuenta corriente del taller\r\n                setActualAccount(res);\r\n                console.log(owedMoney);\r\n                console.log(res);\r\n                console.log((owedMoney < res) ? owedMoney : res)\r\n                setAccount((owedMoney < res) ? owedMoney : res);//account debe ser el menor de owedMoney y res, ya que si owedMoney es mayor a res, no alcanza a pagar todo, mientras que si totalMoney es menor a res, el taller va a tener un resto de cuenta corriente\r\n            });\r\n    }, [selectedTask]);\r\n\r\n    useEffect(() => {\r\n        let delivered = input.quantity, totalMoney = selectedTask.quantity * selectedTask.price;//delivered es la cantidad total devuelta por el taller (en todas las partes) y totalMoney es lo que se deberá pagar por la tarea entera\r\n        parts.map(part => delivered += part.quantity);//Sumar a delivered todas las cantidades entregadas en cada parte\r\n        setDelivered(delivered);\r\n        if (quantityBackUp !== input.quantity) {//Si se modificó la cantidad\r\n            input.money = input.quantity * selectedTask.price - account;//Le recomienda al usuario pagar todo lo que debe pagar (lo entregado en esta parte * el precio acordado - la cuenta corriente de esta parte)\r\n            input.money = input.money < 0 ? 0 : input.money;//No se le puede recomendar pagar un número negativo\r\n            setQuantityBackUp(input.quantity);//Volver a actualizar la cantidad\r\n        }\r\n        onChange(input, selectedTask.price, selectedTask.quantity - delivered, selectedTask.id,//Se envían los cambios\r\n            (delivered === selectedTask.quantity) || completed, totalMoney - input.quantity < 0, actualAccount - account, account);\r\n        //onChange(data, price, faulty, task, completed, paid, workshopAccount, usedAccount)//objeto con todo lo ingresado, precio, artículos fallados, id de tarea, si se entregaron todos los artículos, si se pagó la totalidad de la tarea, lo que le quedará de cuenta corriente al taller luego de la parte y la cantidad de dinero utilizado de la cuenta corriente\r\n        //workshopAccount: Previamente nosotros hicimos \"setAccount((totalMoney < res) ? totalMoney : res);\". La cuenta corriente del taller quedará: Si account === totalMoney, res - totalMoney, de otra forma, 0\r\n    }, [input, completed, refund]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n    const inputField = (property, total) => {//Función que devuelve un inputbox para ingresar datos al objeto input. propery\r\n        //property es la propiedad de input que se quiere modificar con el inputbox y total es el objeto que contiene todos los totales\r\n        return (\r\n            <FormControl value={input[property]}//Asignar al inputbox la variable input[property], es decir que cada vez que el inputbox se modifica, la variable también y vice versa\r\n                onChange={(e) => {//Cuando cambia el inputbox...\r\n                    if (isNaN(e.target.value) || (total[property] < e.target.value && property !== 'money'))//Si el valor es inválido...\r\n                        return;//Cancelar\r\n                    let aux = { ...input };\r\n                    aux[property] = e.target.value;\r\n                    aux[property] = (refund) ?//Si se está haciendo una devolución de mercadería o se contó mal la mercadería en una parte anterior\r\n                        -Math.abs(aux[property]) ://Poner en negativo lo ingresado (así se suma y no se resta al total)\r\n                        (aux[property] < 0) ? 0 : aux[property];//Si la propiedad es negativa, convertir en 0\r\n                    if (property === 'quantity' || property === 'threads')//Si la propiedad es cantidad o hilos...\r\n                        aux[property] = Math.round(aux[property]);//No puede ser decimal\r\n                    setInput({ ...aux });\r\n                }} />\r\n        );\r\n    }\r\n\r\n    // const updateAccount = () => {//TODO: Ejecutar sólo cuando se aprieta enviar\r\n    //     let totalMoney = selectedTask.quantity * selectedTask.price;//totalMoney es lo que se deberá pagar por la tarea entera\r\n    //     //Previamente nosotros hicimos \"setAccount((totalMoney < res) ? totalMoney : res);\"\r\n    //     //La cuenta corriente del taller quedará: Si account === totalMoney, res - totalMoney, de otra forma, 0\r\n    //     Axios.put('http://localhost:3307/setAccount', { money: ((totalMoney === account) ? res - totalMoney : 0), name })//Actualizar el dinero que posee a cuenta el taller\r\n    // }\r\n\r\n    const getTable = () => {\r\n\r\n        let total = {\r\n            quantity: selectedTask.quantity,\r\n            weight: selectedTask.weight,\r\n            money: selectedTask.quantity * selectedTask.price,\r\n            threads: selectedTask.threads\r\n        };\r\n\r\n        return (\r\n            <>\r\n                {parts.map((part, index) => {\r\n                    total = {\r\n                        quantity: total.quantity - part.quantity,\r\n                        weight: total.weight - part.weight,\r\n                        money: total.money - part.money,\r\n                        threads: total.threads - part.threads,\r\n                    };\r\n                    return (\r\n                        <tr key={index}>{/*Muestra el medio*/}\r\n                            <td>{part.date}</td>\r\n                            <td>{part.quantity}</td>\r\n                            <td>{total.quantity}</td>\r\n                            <td>{Number(part.weight).toFixed(1)}</td>\r\n                            <td>{Number(total.weight).toFixed(1)}</td>\r\n                            <td>{part.threads}</td>\r\n                            <td>{total.threads}</td>\r\n                            <td>{'$' + Number(part.money).toFixed(1)}</td>\r\n                            <td>{ }</td>\r\n                            <td>{'$' + Number(total.money).toFixed(1)}</td>\r\n                        </tr>\r\n                    );\r\n                })}\r\n                <tr>{/*Muestra la última fila*/}\r\n                    <td>{moment(new Date()).format('DD/MM/YYYY')}</td>\r\n                    <td>{inputField('quantity', total)}</td>\r\n                    <td>{total.quantity - input.quantity}</td>\r\n                    <td>{inputField('weight', total)}</td>\r\n                    <td>{(total.weight - input.weight).toFixed(1)}</td>\r\n                    <td>{inputField('threads', total)}</td>\r\n                    <td>{total.threads - input.threads}</td>\r\n                    <td>{inputField('money', total)}</td>\r\n                    <td>{'$' + account}</td>\r\n                    <td>{'$' + (total.money - input.money - account).toFixed(1)}</td>\r\n                </tr>\r\n            </>\r\n        )\r\n    }\r\n\r\n    const getExceeded = () => {//Devuelve true si se excedió la fecha de entrega\r\n        if (!selectedTask.deadline)\r\n            return;\r\n        let today = new Date();\r\n        today.setHours(0, 0, 0, 0);\r\n        var dateParts = selectedTask.deadline.split('/');\r\n        var deadline = new Date(+dateParts[2], dateParts[1] - 1, +dateParts[0]);\r\n        return today > deadline;\r\n    }\r\n\r\n    if (name !== '') {\r\n        Axios.post('http://localhost:3307/getUnpaidTasks', { name }).then((response) => {\r\n            if (response.data.length === 0)\r\n                return;\r\n            setTasks(response.data);\r\n        });\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div style={{ 'justifyContent': 'space-between', 'display': 'flex', 'alignItems': 'baseline' }}>\r\n                <TaskRequest setSelectedTask={setSelectedTask} tasks={tasks} title={title} setTitle={setTitle} />\r\n                <h4 style={{ 'color': getExceeded() ? 'red' : 'green' }}>\r\n                    {(selectedTask === '') ? null : selectedTask.deadline}\r\n                </h4>\r\n            </div>\r\n            {title === 'Elegir tarea' ? <></> :\r\n                <>\r\n                    <Form.Check onChange={() => {\r\n                        setRefund(!refund);\r\n                        input.money = -input.money;\r\n                        input.quantity = -input.quantity;\r\n                        input.threads = -input.threads;\r\n                        input.weight = -input.weight;\r\n                    }} label=\"Devolución o corrección\" />\r\n                    <Form.Check onChange={() => setCompleted(!completed)} label=\"Tarea cerrada\" />\r\n                    <Table striped bordered id=\"taskTable\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th>Fecha</th>\r\n                                <th>Cantidad entregada por el taller</th>\r\n                                <th>Cantidad total de la tarea</th>\r\n                                <th>Peso entregado por el taller</th>\r\n                                <th>Peso total</th>\r\n                                <th>Hilos devueltos</th>\r\n                                <th>Hilos totales</th>\r\n                                <th>Dinero entregado</th>\r\n                                <th>Dinero a cuenta</th>\r\n                                <th>Dinero total</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr style={{ 'backgroundColor': 'green' }}>{/*Muestra el primero*/}\r\n                                <td>{selectedTask.exitDate}</td>\r\n                                <td></td>\r\n                                <td>{selectedTask.quantity}</td>\r\n                                <td></td>\r\n                                <td>{selectedTask.weight}</td>\r\n                                <td></td>\r\n                                <td>{selectedTask.threads}</td>\r\n                                <td></td>\r\n                                <td></td>\r\n                                <td>{'$' + selectedTask.price * selectedTask.quantity}</td>\r\n                            </tr>\r\n                            {getTable()}\r\n                        </tbody>\r\n                    </Table>\r\n                </>\r\n            }\r\n        </>\r\n    );\r\n}"]},"metadata":{},"sourceType":"module"}